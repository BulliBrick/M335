
<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Urban Garden - Dashboard
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="dashboard-container">
    <!-- Gardens Section -->
    <div class="gardens-section">
      <div class="header">
        <h2>My Gardens</h2>
      </div>
      <div class="gardens-list" *ngIf="gardens.length > 0">

        <ion-card *ngFor="let garden of gardens" (click)="openGarden(garden.id)">
          <ion-card-header>
            <ion-card-title>{{ garden.name }}</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <p>Location: {{ garden.location }}</p>
            <p>Size: {{ garden.size }}</p>
          </ion-card-content>
        </ion-card>
      </div>

      <div class="no-gardens" *ngIf="gardens.length === 0">
        <ion-icon name="leaf-outline" size="large"></ion-icon>
        <p>Your gardens will appear here</p>
        <ion-button (click)="createNewGarden()">Create Your First Garden</ion-button>
      </div>
      <div class="no-gardens" *ngIf="gardens.length !== 0">
        <ion-icon name="leaf-outline" size="large"></ion-icon>
        <ion-button (click)="createNewGarden()">New Garden</ion-button>
      </div>
    </div>

    <!-- Weather Section -->
    <div class="weather-section" [class.expanded]="isWeatherExpanded" (click)="toggleWeather()">
      <div class="weather-section" *ngIf="weatherData">
        <!-- Current Weather Widget -->
        <div class="weather-widget">
          <h4>Current Weather</h4>
          <div class="weather-content">
            <img 
              [src]="'https://openweathermap.org/img/wn/' + weatherData.current.weather[0].icon + '@2x.png'" 
              [alt]="weatherData.current.weather[0].description"
              class="weather-icon"
            >
            <div class="weather-details">
              <p class="temperature">{{ weatherData.current.temp | number:'1.0-0' }}째C</p>
              <p class="feels-like">Feels like {{ weatherData.current.feels_like | number:'1.0-0' }}째C</p>
              <p class="conditions">{{ weatherData.current.weather[0].description | titlecase }}</p>
              <div class="additional-info">
                <div class="info-item">
                  <ion-icon name="water"></ion-icon>
                  <span>{{ weatherData.current.humidity }}%</span>
                </div>
                <div class="info-item">
                  <ion-icon name="speedometer"></ion-icon>
                  <span>{{ weatherData.current.wind_speed | number:'1.0-1' }} m/s</span>
                </div>
                <div class="info-item">
                  <ion-icon name="sunny"></ion-icon>
                  <span>UV: {{ weatherData.current.uvi | number:'1.0-1' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <!-- Forecast Widgets -->
        <div class="weather-widget" *ngFor="let day of weatherData.daily.slice(0, 2)">
          <h4>{{ day.dt * 1000 | date:'EEEE' }}</h4>
          <div class="weather-content">
            <img 
              [src]="'https://openweathermap.org/img/wn/' + day.weather[0].icon + '@2x.png'" 
              [alt]="day.weather[0].description"
              class="weather-icon"
            >
            <div class="weather-details">
              <div class="temp-range">
                <span class="max-temp">{{ day.temp.max | number:'1.0-0' }}째</span>
                <span class="min-temp">{{ day.temp.min | number:'1.0-0' }}째</span>
              </div>
              <p class="conditions">{{ day.weather[0].description | titlecase }}</p>
              <p class="summary">{{ day.summary }}</p>
              <div class="additional-info">
                <div class="info-item">
                  <ion-icon name="water"></ion-icon>
                  <span>{{ day.humidity }}%</span>
                </div>
                <div class="info-item">
                  <ion-icon name="speedometer"></ion-icon>
                  <span>{{ day.wind_speed | number:'1.0-1' }} m/s</span>
                </div>
                <div class="info-item">
                  <ion-icon name="rainy"></ion-icon>
                  <span>{{ (day.pop * 100) | number:'1.0-0' }}%</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        <!-- Weather Alert -->
        <div class="weather-alert" *ngIf="weatherData.alerts && weatherData.alerts.length > 0">
          <ion-icon name="warning"></ion-icon>
          <div class="alert-content">
            <h4>{{ weatherData.alerts[0].event }}</h4>
            <p>{{ weatherData.alerts[0].description }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-content>